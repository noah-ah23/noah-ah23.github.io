<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>✨Katzenkarten — </title>
  <style>
    :root{--bg:#0b0620;--card:#191226;--accent:#b993ff;--gold:#ffd86b;--muted:rgba(255,255,255,0.07);--glass:rgba(255,255,255,0.04);--card-w:240px;--card-h:340px;font-family: Inter, ui-sans-serif, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial}
    *{box-sizing:border-box}
    html,body,#root{height:100%}
    body{margin:0; background: radial-gradient(ellipse at 10% 10%, rgba(185,145,255,0.04), transparent 12%), radial-gradient(ellipse at 90% 90%, rgba(255,216,107,0.02), transparent 12%), var(--bg); color:#efeefe; display:flex; align-items:center; justify-content:center; padding:28px}
         
    @keyframes float {
      0%, 100% {
        transform: translate(0, 0) rotate(0deg);
      }
      25% {
        transform: translate(2%, 2%) rotate(5deg);
      }
      50% {
        transform: translate(-2%, 1%) rotate(-5deg);
      }
      75% {
        transform: translate(1%, -2%) rotate(3deg);
      }
    }
    
    body{
      margin:0; 
      background: var(--bg);
      color:#efeefe; 
      display:flex; 
      align-items:center; 
      justify-content:center; 
      padding:28px;
      position: relative;
      min-height: 100vh;
    }
    .app{width:100%; max-width:980px}
    header{display:flex; align-items:center; justify-content:space-between; margin-bottom:18px; animation: fadeIn 0.8s ease-out}
    .logo{width:56px;height:56px;border-radius:12px;background:linear-gradient(135deg,var(--accent),var(--gold));display:flex;align-items:center;justify-content:center;box-shadow:0 8px 30px rgba(0,0,0,0.6); animation: pulse 2s infinite}
    h1{font-size:20px;margin:0}
    p.lead{margin:0;opacity:0.9;font-size:13px}

    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    @keyframes slideIn {
      from { opacity: 0; transform: translateX(-20px); }
      to { opacity: 1; transform: translateX(0); }
    }

    .card-area{background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent); padding:22px; border-radius:16px; box-shadow: 0 20px 50px rgba(0,0,0,0.6)}

    /* layout */
    .center{display:flex; gap:24px; align-items:flex-start}
    .left{flex:1}
    .right{width:360px}

    /* start / quiz */
    .start{padding:28px; text-align:center}
    .btn{background:linear-gradient(90deg,var(--accent),var(--gold)); border:none; color:#14051a; padding:12px 16px; border-radius:12px; font-weight:700; cursor:pointer}
    .ghost{
      background:transparent; 
      border:1px solid var(--muted); 
      padding:10px 12px; 
      border-radius:10px; 
      color:inherit; 
      cursor:pointer;
      transition: all 0.3s ease;
    }
    .ghost:hover {
      border-color: var(--gold);
      box-shadow: 0 0 10px rgba(255,216,107,0.1);
      transform: translateY(-1px);
    }
    .ghost:active {
      transform: translateY(0px);
    }

    .question{background:rgba(255,255,255,0.02); padding:18px; border-radius:12px; margin-bottom:12px; animation: fadeIn 0.6s ease-out}
    .q-title{font-weight:700;margin-bottom:8px}
    .options{display:flex;flex-direction:column; gap:8px}
    .opt{
      background:var(--glass); 
      padding:10px 12px; 
      border-radius:10px; 
      cursor:pointer; 
      transition: all 0.3s ease;
      border: 2px solid transparent;
    }
    .opt:hover{
      background:rgba(255,255,255,0.08); 
      transform: translateX(5px);
      border-color: rgba(255,216,107,0.2);
    }
    .opt.selected{
      border: 2px solid var(--gold);
      background: rgba(255,216,107,0.05);
      box-shadow: 0 0 15px rgba(255,216,107,0.1);
      transform: translateX(5px);
    }
    
    .btn{
      background:linear-gradient(90deg,var(--accent),var(--gold)); 
      border:none; 
      color:#14051a; 
      padding:12px 16px; 
      border-radius:12px; 
      font-weight:700; 
      cursor:pointer;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }
    
    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(187, 154, 245, 0.3);
    }
    
    .btn:after {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
      transform: rotate(45deg);
      animation: shimmer 3s infinite;
    }
    
    @keyframes shimmer {
      0% { transform: translateX(-100%) rotate(45deg); }
      100% { transform: translateX(100%) rotate(45deg); }
    }

    /* card display */
    .card-wrap{
      width:var(--card-w);
      height:var(--card-h);
      perspective:1200px;
      margin:0 auto;
      position: relative;
    }
    .card-wrap:before {
      content: '';
      position: absolute;
      inset: -3px;
      background: linear-gradient(45deg, var(--gold), transparent, var(--gold));
      border-radius: 16px;
      opacity: 0;
      transition: opacity 0.5s ease;
   /*   animation: borderRotate 4s linear infinite; */
      filter: blur(8px);
    }
    .card-wrap:hover:before {
      opacity: 0.5;
    }
    .card{
      width:100%;
      height:100%;
      border-radius:14px;
      transform-style:preserve-3d;
      transition:all 700ms cubic-bezier(.2,.9,.3,1);
      box-shadow:0 12px 40px rgba(0,0,0,0.6);
      cursor:pointer;
      border: 2px solid transparent;
    }
    .card:hover {
      border-color: var(--gold);
      box-shadow: 0 15px 45px rgba(255,216,107,0.2);
    }
    .card.flipped{
      transform:rotateY(180deg) translateY(-6px) scale(1.02);
      border-color: var(--gold);
      box-shadow: 0 20px 60px rgba(255,216,107,0.3);
    }
    .face{
      position:absolute;
      inset:0;
      border-radius:14px;
      backface-visibility:hidden;
      overflow:hidden;
      display:flex;
      flex-direction:column;
      transition: all 0.3s ease;
    }
    .front{
      background:linear-gradient(135deg, rgba(255,255,255,0.04), rgba(0,0,0,0.1));
      align-items:center;
      justify-content:center;
      padding:16px;
      position: relative;
    }
    .front:after {
      content: '✨';
      position: bottom;
      bottom: 42px;
      font-size: 40px;
      opacity: 0.8;
      animation: sparkle 2s ease-in-out infinite;
    }
    .back{
      transform:rotateY(180deg);
      background:linear-gradient(180deg, rgba(0,0,0,0.15), transparent);
    }
    .back img{
      width:100%;
      height:62%;
      object-fit:cover;
      transition: transform 0.3s ease;
    }
    .back:hover img {
      transform: scale(1.03);
    }
    .back .body{
      padding:12px;
      display:flex;
      flex-direction:column;
      gap:8px;
      background: linear-gradient(0deg, rgba(255,216,107,0.03), transparent);
    }

    @keyframes borderRotate {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    @keyframes sparkle {
      0%, 100% { transform: scale(1); opacity: 0.6; }
      50% { transform: scale(1.2); opacity: 0.8; }
    }

    .meta{display:flex;justify-content:space-between;align-items:center;margin-top:12px}
    .small{
      font-size:12px;
      opacity:0.8;
      transition: opacity 0.3s ease;
    }
    .small:hover {
      opacity: 1;
    }

    footer{
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-top:14px;
      padding: 14px;
      border-top: 1px solid rgba(255,216,107,0.1);
    }

    /* Zusätzliche mystische Effekte */
    .q-title {
      background: linear-gradient(90deg, var(--accent), var(--gold));
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
      display: inline-block;
      position: relative;
    }
    
    .card-area {
      position: relative;
      overflow: hidden;
    }
    
    .card-area:before {
      content: '';
      position: absolute;
      top: 0;
      left: -50%;
      width: 200%;
      height: 1px;
      background: linear-gradient(90deg, 
        transparent, 
        rgba(255,216,107,0.2),
        rgba(185,145,255,0.2),
        transparent
      );
      animation: lightBeam 8s linear infinite;
    }
    
    @keyframes lightBeam {
      0% { transform: translateX(-100%); }
      100% { transform: translateX(100%); }
    }
    
    @keyframes attention {
      0%, 100% { transform: scale(1); box-shadow: 0 0 0 rgba(255,216,107,0); }
      50% { transform: scale(1.1); box-shadow: 0 0 20px rgba(255,216,107,0.3); }
    }

    /* Audio Player Styles */
    .audio-control {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: rgba(0,0,0,0.4);
      border: 1px solid var(--gold);
      border-radius: 50%;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s ease;
      z-index: 1000;
    }
    
    .audio-control:hover {
      transform: scale(1.1);
      box-shadow: 0 0 15px rgba(255,216,107,0.3);
    }
    
    .audio-control.playing {
      border-color: var(--accent);
    }

    /* stars */
    .stars{position:fixed;inset:0;pointer-events:none}
    .star{
      position:absolute;
      width:3px;
      height:3px;
      background:rgba(255,255,255,0.06);
      border-radius:50%;
      animation:tw 5s infinite;
      filter: blur(0.5px);
    }
    .star.accent {
      background: rgba(185,145,255,0.1);
      width: 4px;
      height: 4px;
    }
    .star.gold {
      background: rgba(255,216,107,0.1);
      width: 4px;
      height: 4px;
    }
    @keyframes tw{
      0%{opacity:0.2;transform:translateY(0)}
      50%{opacity:1;transform:translateY(-2px)}
      100%{opacity:0.2;transform:translateY(0)}
    }

    /* Info Modal */
    .modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.7);
      backdrop-filter: blur(5px);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
    }
    
    .modal-overlay.active {
      opacity: 1;
      pointer-events: auto;
    }
    
    .info-modal {
      background: linear-gradient(135deg, var(--card), rgba(25,18,38,0.95));
      border: 1px solid var(--muted);
      border-radius: 16px;
      padding: 24px;
      max-width: 90%;
      width: 480px;
      position: relative;
      transform: translateY(20px);
      opacity: 0;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .modal-overlay.active .info-modal {
      transform: translateY(0);
      opacity: 1;
    }
    
    .info-modal h3 {
      color: var(--gold);
      margin: 0 0 16px 0;
      font-size: 1.5em;
    }
    
    .info-modal p {
      margin: 8px 0;
      line-height: 1.5;
    }
    
    .info-modal .close-btn {
      position: absolute;
      top: 16px;
      right: 16px;
      background: none;
      border: none;
      color: var(--muted);
      cursor: pointer;
      padding: 8px;
      font-size: 20px;
      transition: color 0.3s ease;
    }
    
    .info-modal .close-btn:hover {
      color: var(--gold);
    }
    
    .info-modal .content {
      margin-bottom: 20px;
    }
    
    .info-modal .actions {
      display: flex;
      justify-content: flex-end;
      gap: 12px;
    }

    /* Crystal Ball Modal */
    .crystal-modal {
      position: fixed;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(46, 1, 66, 0.85);
      backdrop-filter: blur(8px);
      z-index: 1000;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
    }

    .crystal-modal.active {
      opacity: 1;
      pointer-events: auto;
    }

    .crystal-container {
      position: relative;
      width: 280px;
      height: 280px;
      perspective: 1000px;
      transform-style: preserve-3d;
    }

    .crystal-ball {
      position: relative;
      width: 100%;
      height: 100%;
      background: radial-gradient(circle at 30% 30%, 
        rgba(255,255,255,0.1) 0%,
        rgba(185,145,255,0.05) 30%,
        rgba(11,6,32,0.8) 100%
      );
      border-radius: 50%;
      box-shadow: 
        0 0 50px rgba(185,145,255,0.2),
        inset 0 0 30px rgba(255,216,107,0.2);
     /* animation: floatBall 6s ease-in-out infinite; */
      transform-style: preserve-3d;
    }

    .crystal-ball::before {
      content: '';
      position: absolute;
      width: 100%;
      height: 100%;
      border-radius: 50%;
      background: radial-gradient(circle at 70% 70%, 
        rgba(255,255,255,0.3) 0%,
        transparent 20%
      );
    }

    .crystal-text {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      text-align: center;
      color: var(--gold);
      font-size: 16px;
      width: 80%;
      text-shadow: 0 0 10px rgba(246, 207, 99, 0.662);
      opacity: 0;
      animation: fadeInText 0.5s ease forwards 0.5s;
    }

    .crystal-sparkles {
      position: absolute;
      inset: -20px;
      pointer-events: none;
    }

    .sparkle {
      position: absolute;
      width: 4px;
      height: 4px;
      background: var(--gold);
      border-radius: 50%;
      animation: sparkleFloat 3s ease-in-out infinite;
    }

    @keyframes floatBall {
      0%, 100% { transform: translateY(0) rotateY(0deg); }
      50% { transform: translateY(-20px) rotateY(180deg); }
    }

    @keyframes fadeInText {
      from { opacity: 0; transform: translate(-50%, -30%); }
      to { opacity: 1; transform: translate(-50%, -50%); }
    }

    @keyframes sparkleFloat {
      0% { transform: translate(0, 0) scale(0); opacity: 0; }
      50% { transform: translate(var(--tx), var(--ty)) scale(1); opacity: 1; }
      100% { transform: translate(var(--tx2), var(--ty2)) scale(0); opacity: 0; }
    }

    @media (max-width:920px){.center{flex-direction:column}.right{width:100%}}
    @media (max-width:520px){:root{--card-w:190px;--card-h:280px}}
  </style>
</head>
<body>
  <div id="root"></div>
  <div class="mystic-bg" aria-hidden="true">
    <div class="mystic-orb"></div>
    <div class="mystic-orb"></div>
    <div class="mystic-orb"></div>
  </div>
  <div class="stars" aria-hidden="true"></div>
  <audio id="bgMusic" loop>
    <source src="https://noah-ah23.github.io/music/bgmusicn.mp3" type="audio/mpeg">
  </audio>

  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/babel-standalone@6.26.0/babel.min.js"></script>

  <script type="text/babel">
  const {useState,useEffect} = React;


  // cards (mystic cats) — images are placeholder: replace with local if desired
  const CARDS = [
    {id:'lazy', title:'The Lazy Cat', img:'https://i.imgur.com/1XPFGJU.jpeg', desc:'Du siehst mehr, wenn du nichts tust. Ein Nickerchen zu viel geht nich.'},
    {id:'chaos', title:'The Chaotic Cat', img:'https://i.imgur.com/S7NeKMY.jpeg', desc:'Chaos bringt kreative Lösungen. (Aber muss ich Angst vor dir haben?)'},
    {id:'wise', title:'The Wise Cat', img:'https://i.imgur.com/nTlWdRZ.jpeg', desc:'Deine Intuition ist schärfer als du denkst. Vertraue deinem Schnurren.'},
    {id:'snack', title:'The Snack Cat', img:'https://i.imgur.com/H2i2bDs_d.webp?maxwidth=520&shape=thumb&fidelity=high', desc:'Genuss ist dein Pfad. Kleine Belohnungen (Monster) führen zu großem Glück.'},
    {id:'shadow', title:'The Batcat', img:'https://i.imgur.com/XqeWqgI.png', desc:'Da da da da da BATMAN (Wie hast du das hier rausbekommen?)'},
    {id:'ninja', title:'The Stealth Cat', img:'https://i.imgur.com/SC3o9Xh_d.webp?maxwidth=520&shape=thumb&fidelity=high', desc:'Leise und geschmeidig ist dein Weg.. außer um 3 Uhr nachts auf der knarrenden Treppe ._.'},
    {id:'tech', title:'The Cyber Cat', img:'https://i.imgur.com/VcDopEE_d.webp?maxwidth=520&shape=thumb&fidelity=high', desc:'Zwischen Tastaturen und Kabeln findest du dein Glück. Hast du schon probiert, es aus- und wieder einzuschalten?'},
    {id:'adventure', title:'The Explorer Cat', img:'https://i.imgur.com/QjgBDb5_d.webp?maxwidth=520&shape=thumb&fidelity=high', desc:'Die Welt ist dein Kratzbaum! Neue Höhen warten auf dich. Vergiss nur die Essenszeit nicht.'},
    {id:'royal', title:'The Majestic Cat', img:'https://i.imgur.com/pr4zbRX.jpeg', desc:'Du bist von königlichem Geblüt... bis das Leckerli-Tütchen raschelt.'},
    {id:'scientist', title:'The Mad Cat Scientist', img:'https://i.imgur.com/kcLIvpC.jpeg', desc:'Deine Experimente mit der Schwerkraft sind legendär. Besonders die mit Gläsern am Tischrand.'}
  ];

  // quiz questions — each option has a score vector to weight towards cards
  const QUESTIONS = [
    {q:'Wie startest du deinen Tag?', opts:[
      {t:'Langsam, mit Tee 🍵',v:[1,0,0,1,0,0,0,0,1,0]},
      {t:'Panik! Der Bus kommt gleich 🚎',v:[0,1,0,0,1,1,0,0,0,0]},
      {t:'Voller Energie 🌟',v:[0,0,1,0,0,0,1,1,0,0]}
    ]},
    {q:'Was brauchst du Heute?', opts:[
      {t:'Ruhe - Heute Meditieren 🧘‍♀️',v:[1,0,1,0,0,0,0,0,0,1]},
      {t:'Kreatives - Lass mich basteln 🎨',v:[0,1,0,0,0,0,0,1,0,1]},
      {t:'Komfort - Ich brauch Monster 🥤',v:[0,0,0,1,1,0,0,0,1,0]}
    ]},
    {q:'Wo warst du letzte Nacht?', opts:[
      {t:'Schlafen natürlich 😴',v:[1,0,0,0,0,0,0,0,1,1]},
      {t:'Partyyyy 🥳',v:[0,0,0,0,1,1,0,1,0,0]},
      {t:'Online Shopping 🛒',v:[0,1,0,1,0,0,1,0,0,0]}
    ]},
    {q:'Dein Lieblingszeitvertreib?', opts:[
      {t:'Fenster-Fernsehen 👀',v:[1,0,1,0,0,0,0,0,0,1]},
      {t:'Dinge vom Tisch werfen 🏃‍♂️',v:[0,1,0,0,0,0,0,0,1,1]},
      {t:'Neue Orte erkunden 🗺️',v:[0,0,0,1,1,1,0,0,0,0]}
    ]},
    {q:'Wie gehst du mit Technik um?', opts:[
      {t:'Taste drücken bis es geht 🔄',v:[0,1,0,0,0,0,1,0,0,1]},
      {t:'Handbuch? Was ist das? 📱',v:[1,0,0,1,0,0,0,1,0,0]},
      {t:'Systematisch testen 🔎',v:[0,0,1,0,1,0,0,0,1,0]}
    ]},
    {q:'Dein Stil beim Essen?', opts:[
      {t:'Feinschmecker 🍽️',v:[0,0,0,1,0,0,0,0,1,1]},
      {t:'Egal was 🍗',v:[1,1,0,0,0,0,0,1,0,0]},
      {t:'Erst ein Foto machen! 📸',v:[0,0,1,0,1,1,0,0,0,0]}
    ]},
    {q:'Reaktion auf Gossip?', opts:[
      {t:'Überraschung 🙈',v:[0,0,0,0,1,1,0,0,0,1]},
      {t:'Neugierde 🔍',v:[0,0,1,0,0,0,1,1,0,0]},
      {t:'Ignorant 👑',v:[1,1,0,0,0,0,0,0,1,0]}
    ]},
    {q:'Was ist dein Element?', opts:[
      {t:'Gemütliches Sofa 😴',v:[1,0,0,0,0,0,0,1,1,0]},
      {t:'Die Natur 🏔️',v:[0,1,1,0,1,0,0,0,0,0]},
      {t:'Bildschirm-Licht 💻',v:[0,0,0,1,0,1,1,0,0,0]}
    ]},
    {q:'Deine Superkraft wäre...', opts:[
      {t:'Unsichtbarkeit 👻',v:[0,0,0,0,1,1,0,0,0,1]},
      {t:'Teleportation 🗾',v:[1,0,0,1,0,0,0,1,0,0]},
      {t:'Gedankenkontrolle 🤯',v:[0,1,1,0,0,0,1,0,0,0]}
    ]},
    {q:'Deine Lieblingsjahreszeit?', opts:[
      {t:'Sommer - Fenster auf! 🌞',v:[0,0,0,1,0,0,0,1,1,0]},
      {t:'Winter - Kuschelig warm 🧶',v:[1,0,1,0,0,0,0,0,0,1]},
      {t:'Sturmzeit - Chaos! 🌪️',v:[0,1,0,0,1,1,0,0,0,0]}
    ]}
  ];

  function sumVectors(vs){
    const sum = [0,0,0,0,0];
    vs.forEach(v=>v.forEach((n,i)=>sum[i]+=n));
    return sum;
  }

  function pickCardFromScore(score){
    // choose max index; fallback to random
    const idx = score.reduce((best,val,i,arr)=> val>arr[best]? i:best,0);
    if(score.every(s=>s===0)) return CARDS[Math.floor(Math.random()*CARDS.length)];
    return CARDS[idx] || CARDS[0];
  }

  function Card({data,flipped,onClick}){
    return (
      <div className="card-wrap" onClick={onClick} role="button" tabIndex={0} onKeyDown={(e)=>{if(e.key==='Enter') onClick()}}>
        <div className={`card ${flipped? 'flipped':''}`}>
          <div className="face front">
            <div style={{textAlign:'center'}}>
              <div className="small" style={{fontSize:15}}>Klicke, um die Weissagung zu enthüllen</div>
            </div>
          </div>
          <div className="face back">
            <img src={data.img} alt={data.title} />
            <div className="body">
              <div style={{fontWeight:800}}>{data.title}</div>
              <div className="small">{data.desc}</div>
            </div>
          </div>
        </div>
      </div>
    )
  }

  function CrystalBall({ isOpen, onClose }) {
    const [wisdom, setWisdom] = useState('');
    
    const wisdomMessages = [
      "Die Kugel sagt...genug palavert, beantworte die 10 Fragen",
      "Die Kugel sagt...Du brauchst ein Buch",
      "Die Kugel ist genervt...Ein Impresario hat Verpflichtungen, Angelegenheiten, Wichtigeres zu tun, Eulen nach Athen und so weiter und so fort",
      "Die Kugel meint...Noah muss aufhören Texte für die Kugel zu schreiben",
      "Die Kugel sagt...Kippt das Verwunderliche ins Bizarre, wird der Verstand ranzig",
      "Die Kugel denkt...Zuversicht und Leichtsinn sind zwei Seiten derselben Medaille",
      "Die Kugel denkt...Logik kann Sinnlos sein",
      "Die Kugel weiß...Dein Kopf ist mehr als ein Hutständer",
      "Die Kugel sagt...Alle großen Echsen in Geschichte und Mythologie haben einen ähnlichen Körperbau. Zufall?",
      "Die Kugel sagt...Poesie und Tanz sind ohne Klang nur Worte und Bewegung",
      "Die Kugel sieht...Monster",
      "Die Kugel sagt...Deine Zukunft ist so strahlend wie frisch poliertes Fell.",
      "Die Kugel sagt...Heute ist ein guter Tag für ein Nickerchen.",
      "Die Kugel sieht... einen Noah in deiner Zukunft!"
    ];

    useEffect(() => {
      if (isOpen) {
        const randomIndex = Math.floor(Math.random() * wisdomMessages.length);
        setWisdom(wisdomMessages[randomIndex]);

        // Add sparkles
        const container = document.querySelector('.crystal-sparkles');
        if (container) {
          container.innerHTML = '';
          for (let i = 0; i < 20; i++) {
            const sparkle = document.createElement('div');
            sparkle.className = 'sparkle';
            sparkle.style.setProperty('--tx', `${(Math.random() - 0.5) * 100}px`);
            sparkle.style.setProperty('--ty', `${(Math.random() - 0.5) * 100}px`);
            sparkle.style.setProperty('--tx2', `${(Math.random() - 0.5) * 150}px`);
            sparkle.style.setProperty('--ty2', `${(Math.random() - 0.5) * 150}px`);
            sparkle.style.left = `${Math.random() * 100}%`;
            sparkle.style.top = `${Math.random() * 100}%`;
            sparkle.style.animationDelay = `${Math.random() * 3}s`;
            container.appendChild(sparkle);
          }
        }
      }
    }, [isOpen]);

    return (
      <div className={`crystal-modal ${isOpen ? 'active' : ''}`}>
        <div className="crystal-container">
          <div className="crystal-ball">
            <div className="crystal-sparkles"></div>
            <div className="crystal-text">{wisdom}</div>
          </div>
        </div>
        <button 
          className="close-btn" 
          onClick={onClose}
          style={{
            position: 'absolute',
            top: '20px',
            right: '20px',
            background: 'none',
            border: 'none',
            color: 'var(--gold)',
            fontSize: '24px',
            cursor: 'pointer'
          }}
        >
          ×
        </button>
      </div>
    );
  }

  function App(){
    const [step,setStep] = useState('start'); // start, quiz, reveal
    const [qIndex,setQIndex] = useState(0);
    const [answers,setAnswers] = useState([]);
    const [selected,setSelected] = useState(null);
    const [resultCard,setResultCard] = useState(null);
    const [flipped,setFlipped] = useState(false);
    const [fadeOut, setFadeOut] = useState(false);
    const [isPlaying, setIsPlaying] = useState(false);
    const [showInfo, setShowInfo] = useState(false);
    const [showCrystal, setShowCrystal] = useState(false);

    useEffect(()=>{ 
      mountStars();
      
      // Initialize audio
      const audio = document.getElementById('bgMusic');
      if (audio) {
        audio.volume = 0.3; // Set initial volume to 30%
        
        // Versuche die Musik automatisch zu starten
        audio.play().then(() => {
          setIsPlaying(true);
        }).catch(() => {
          // Wenn autoplay blockiert wurde, zeigen wir einen dezenten Hinweis
          const musicControl = document.querySelector('.audio-control');
          if (musicControl) {
            musicControl.style.animation = 'attention 2s ease-in-out';
          }
        });
      }
    },[]);

    function toggleMusic() {
      const audio = document.getElementById('bgMusic');
      if (audio) {
        if (isPlaying) {
          audio.pause();
        } else {
          audio.play();
        }
        setIsPlaying(!isPlaying);
      }
    }

    // Enhanced star generation
    function mountStars() {
      const stars = document.querySelector('.stars');
      if(!stars) return;
      stars.innerHTML = '';
      for(let i = 0; i < 100; i++) {
        const star = document.createElement('div');
        star.className = `star ${Math.random() > 0.9 ? 'accent' : Math.random() > 0.9 ? 'gold' : ''}`;
        star.style.left = `${Math.random() * 100}%`;
        star.style.top = `${Math.random() * 100}%`;
        star.style.animationDelay = `${Math.random() * 5}s`;
        stars.appendChild(star);
      }
    }

    function start(){ setStep('quiz'); setQIndex(0); setAnswers([]); setSelected(null); setResultCard(null); setFlipped(false); }

    function chooseOption(opt){ setSelected(opt); }

    function next(){ 
      if(selected==null) return;
      setFadeOut(true);
      setTimeout(() => {
        const nextAnswers = [...answers, selected.v];
        setAnswers(nextAnswers);
        setSelected(null);
        if(qIndex+1<QUESTIONS.length){
          setQIndex(qIndex+1);
        } else {
          const score = sumVectors(nextAnswers);
          const card = pickCardFromScore(score);
          setResultCard(card);
          setStep('reveal');
        }
        setFadeOut(false);
      }, 300);
    }

    function revealCard(){ setFlipped(true); }

    function again(){ start(); }

    return (
      <div className="app">
        <header>
          <div style={{display:'flex',gap:12,alignItems:'center'}}>
            <div className="logo">🔮</div>
            <div>
              <h1>Ein Katzen Orakel</h1>
              <p className="lead"></p>
            </div>
          </div>
          <div style={{display:'flex',gap:8}}>
            <button className="ghost" onClick={() => setShowCrystal(true)}>Weisheiten 🔮</button>
            <button className="ghost" onClick={()=>{ setStep('start'); setFlipped(false)}}>Neu laden🌐</button>
            <CrystalBall isOpen={showCrystal} onClose={() => setShowCrystal(false)} />
          </div>
        </header>

        <div className="card-area">
          <div className="center">
            <div className="left">

              {step==='start' && (
                <div className="start">
                  <h2>Bereit für dein Schicksal?</h2>
                  <p className="small" style={{marginTop:8}}>Das Orakel stellt dir 10 Fragen. Am Ende erfährst du welche Karte heute zu dir passt🔮</p>
                  <div style={{marginTop:18}}>
                    <button className="btn" onClick={start}>Ritual Beginnen🌠</button>
                  </div>
                </div>
              )}

              {step==='quiz' && (
                <div style={{
                  opacity: fadeOut ? 0 : 1,
                  transition: 'opacity 0.3s ease-out'
                }}>
                  <div className="question">
                    <div className="q-title">Frage {qIndex+1} von {QUESTIONS.length}</div>
                    <div style={{fontSize:15, marginBottom:12}}>{QUESTIONS[qIndex].q}</div>
                    <div className="options">
                      {QUESTIONS[qIndex].opts.map((o,oi)=> (
                        <div 
                          key={oi} 
                          className={`opt ${selected===o? 'selected':''}`} 
                          onClick={()=>chooseOption(o)}
                          style={{
                            animation: `slideIn 0.5s ease-out ${oi * 0.1}s both`
                          }}
                        >
                          {o.t}
                        </div>
                      ))}
                    </div>
                  </div>
                  <div style={{display:'flex',gap:8,justifyContent:'flex-end'}}>
 
                    <button className="btn" onClick={next}>Nächste📨</button>
                  </div>
                </div>
              )}

              {step==='reveal' && resultCard && (
                <div style={{textAlign:'center', padding:18}}>
                  <div style={{marginBottom:12}} className="small">Dein Orakel hat geantwortet…</div>
                  <div>
                    <Card data={resultCard} flipped={flipped} onClick={revealCard} />
                  </div>

                  <div style={{marginTop:12, display:'flex', gap:8, justifyContent:'center'}}>
                    <button className="ghost" onClick={()=>{ setFlipped(false)}}>Verbergen🔸</button>
                    <button className="btn" onClick={again}>Nochmal🔸</button>
                  </div>
                </div>
              )}

            </div>

            <aside className="right">
              <div style={{background:'rgba(255,255,255,0.02)', padding:16, borderRadius:12}}>
                <div style={{fontWeight:800}}>Info 🎈</div>
                <div className="small" style={{marginTop:8}}>Antworten beeinflussen die Art der Karte, die du erhältst. Es ist nicht nur Zufall — Trotzdem natürlich nichts ernst nehmen :*) Ich hoffe es ist nicht zu Langweilig, denn hier stecken 700 Zeilen Code drinn</div>

                <div style={{marginTop:12}}>
                  <div style={{fontWeight:700, marginBottom:6}}>Anleitung 👓</div>
                  <ul style={{margin:0,paddingLeft:18}}>
                    <li className="small">Starte das Ritual & Beantworte alle Fragen</li>
                    <li className="small">Klicke am Ende auf die Karte um zu erfahren welche Katze du heute bist</li>
                    <li className="small">Mit "Fragen Überspringen" bekommst du direkt eine neue Karte</li>
                  </ul>
                </div>

                <div style={{marginTop:14,display:'flex',gap:8}}>
                  <button className="ghost" onClick={()=>{ alert('neue Karte basierend auf zufall'); setResultCard(CARDS[Math.floor(Math.random()*CARDS.length)]); setFlipped(false); setStep('reveal') }}>Fragen überspringen</button>

                </div>

              </div>

            </aside>
          </div>

          <div 
            className={`audio-control ${isPlaying ? 'playing' : ''}`} 
            onClick={toggleMusic}
            title={isPlaying ? 'Musik pausieren' : 'Musik abspielen'}
          >
            {isPlaying ? '🔊' : '🔈'}
          </div>

          <footer>
            <div className="small">Gemacht für Milo💗</div>
            <div className="small">von Noah</div>
          </footer>
        </div>
      </div>
    )
  }

  const root = ReactDOM.createRoot(document.getElementById('root'));
  root.render(React.createElement(App));
  </script>
</body>
</html>
